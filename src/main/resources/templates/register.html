<!DOCTYPE html>
<html lang="en" dir="ltr" xmlns:th="http://www.thymeleaf.org">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<title th:text="${pageTitle}">Register</title>

	<!-- <link th:href="@{/login-assets/images/favicon.ico}" rel="icon" type="image/x-icon" /> -->

	<!-- Global stylesheets -->
	<link th:href="@{/login-assets/fonts/inter/inter.css}" rel="stylesheet" type="text/css">
	<link th:href="@{/login-assets/icons/phosphor/styles.min.css}" rel="stylesheet" type="text/css">
	<link th:href="@{/login-assets/css/all.min.css}" id="stylesheet" rel="stylesheet" type="text/css">
	<!-- /global stylesheets -->

	<!-- Core JS files -->
	<script th:src="@{/login-assets/js/jquery/jquery.min.js}"></script>
	<script th:src="@{/login-assets/js/bootstrap/bootstrap.bundle.min.js}"></script>
	<!-- /core JS files -->

	<!-- Theme JS files -->
	<script th:src="@{/login-assets/js/app.js}"></script>
	<!-- /theme JS files -->

</head>

<body>

	<!-- Page content -->
	<div class="page-content">

		<!-- Main content -->
		<div class="content-wrapper">

			<!-- Inner content -->
			<div class="content-inner">

				<!-- Content area -->
				<div class="content d-flex justify-content-center align-items-center">

					<a class="basePath" th:href="@{/}"></a>

					<!-- Registration form -->
					<div class="main-form-container">
						<form id="register-form" class="login-form" role="form" th:action="@{/register}" method="post" autocomplete="off">
							<div class="card mb-0">
								<div class="card-body">
									<div class="text-center mb-3">
										<div class="d-inline-flex align-items-center justify-content-center mb-4 mt-2">
											<!-- <img th:src="@{/login-assets/images/logo.png}" class="h-48px" alt=""> -->
											<h1 class="m-0 p-0">ZPOS</h1>
										</div>
										<h5 class="mb-0">Create account</h5>
										<span class="d-block text-muted">All fields are required</span>

										<div th:if="${param.error}" class="error-message-container d-none text-danger m-2 text-center">Wrong credential</div>
										<div th:if="${param.logout}" class="error-message-container d-none text-success m-2 text-center">You have been logged out</div>
										<div class="error-message-container d-none text-danger m-2 text-center">You have been logged out</div>
									</div>

									<div class="mb-3">
										<label class="form-label">Email</label>
										<div class="form-control-feedback form-control-feedback-start">
											<input type="email" class="form-control" name="email" id="email" placeholder="Email" autocomplete="off" required>
											<div class="form-control-feedback-icon">
												<i class="ph-envelope-simple text-muted"></i>
											</div>
										</div>
									</div>

									<div class="mb-3">
										<label class="form-label">Password</label>
										<div class="form-control-feedback form-control-feedback-start">
											<input type="password" class="form-control" name="password" id="password" placeholder="•••••••••••" autocomplete="off" required>
											<div class="form-control-feedback-icon">
												<i class="ph-lock text-muted"></i>
											</div>
										</div>
									</div>

									<div class="mb-3">
										<label class="form-label">Confirm Password</label>
										<div class="form-control-feedback form-control-feedback-start">
											<input type="password" class="form-control" name="cpassword" id="cpassword" placeholder="•••••••••••" autocomplete="off" required>
											<div class="form-control-feedback-icon">
												<i class="ph-lock text-muted"></i>
											</div>
										</div>
									</div>

									<div class="d-flex align-items-center mb-3">
										<a href="login_password_recover.html" class="ms-auto">Forgot password?</a>
									</div>

									<div class="mb-3">
										<button type="submit" class="btn btn-primary w-100 register-btn">Register</button>
									</div>

									<div class="text-center text-muted content-divider mb-3">
										<span class="px-2">Already have an account?</span>
									</div>

									<div class="mb-3">
										<a th:href="@{/login}" class="btn btn-light w-100">Back to Sign In</a>
									</div>

									<div class="mb-3 text-center" style="font-size: 10px;">
										<span th:text="${'Version - ' + appVersion}"></span>
									</div>
								</div>
							</div>
						</form>
					</div>
					<!-- /login form -->

				</div>
				<!-- /content area -->

			</div>
			<!-- /inner content -->

		</div>
		<!-- /main content -->

	</div>
	<!-- /page content -->


	<script type="text/javascript">
		$(document).ready(function(){
			$('.register-btn').off('click').on('click', function(e){
				e.preventDefault();
				submitMainForm();
			})
	
			/**
			 * Submit main form
			 */
			function submitMainForm(customurl){
				if($('form#register-form').length < 1) return;
	
				var targettedForm = $('form#register-form');
	
				var submitUrl = (customurl != undefined) ? customurl : targettedForm.attr('action');
				var submitType = targettedForm.attr('method');
				var formData = $(targettedForm).serializeArray();
	
				$.ajax({
					url : submitUrl,
					type :submitType,
					data : formData,
					success : function(data) {
						if(data.status == 'SUCCESS'){
							alert(data.message);
							setTimeout(() => {
								window.location.replace(getBasepath() + data.redirecturl);
							}, 1000);
						} else {
							$('.error-message-container').html(data.message);
							$('form#register-form').trigger("reset");
							$('.error-message-container').removeClass('d-none');
							setTimeout(() => {
								$('.error-message-container').addClass('d-none');
							}, 5000);
						}
					}, 
					error : function(jqXHR, status, errorThrown){
						alert("Something went wrong. Please contact with system administrator");
					}
				});
			}
	
			/**
			 * Generate project context path
			 */
			function getBasepath(){
				var basePath = $('a.basePath').attr('href');
				basePath = basePath.split('/')[1];
				var href = location.href.split('/');
				if(basePath != ''){
					return href[0] + '//' + href[2] + '/' + basePath;
				}
				return href[0] + '//' + href[2];
			}
		})
	</script>

</body>
</html>






















	